{% extends "base.html" %}
{% block title %}View Expenses - Expense Tracker{% endblock %}
{% block content %}
<div class="card p-4 shadow">
  <h2 class="mb-3">Your Expenses</h2>

  {% if expenses %}
    <h4 class="mb-3 text-success">
      Total Spent: ₹{{ total_spent }}
    </h4>

    <!-- Table -->
    <table class="table table-striped table-bordered">
      <thead class="table-dark">
        <tr>
          <th>Description</th>
          <th>Amount</th>
          <th>Category</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        {% for expense in expenses %}
        <tr>
          <td>{{ expense.description }}</td>
          <td>₹{{ expense.amount }}</td>
          <td>{{ expense.category }}</td>
          <td>{{ expense.date }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Pie Chart -->
    <h5 class="mt-4">Expenses by Category</h5>
    <canvas id="expenseChart"></canvas>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      const ctx = document.getElementById('expenseChart').getContext('2d');
      new Chart(ctx, {
        type: 'pie',
        data: {
          labels: {{ category_labels | tojson }},
          datasets: [{
            data: {{ category_data | tojson }},
            backgroundColor: ['#007bff','#28a745','#ffc107','#dc3545','#6f42c1','#17a2b8','#6f42c1']
          }]
        }
      });
    </script>
  {% else %}
    <p class="text-muted">No expenses added yet. <a href="/add">Add one now</a>.</p>
  {% endif %}
</div>
{% endblock %}
